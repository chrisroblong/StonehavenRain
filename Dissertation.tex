\documentclass[12pt,a4paper]{report}

\usepackage{graphics}
\usepackage{fullpage,epsf,graphicx}
\usepackage{amsmath}%, amstext,url}
\usepackage{comment}
\usepackage{hyperref}
\usepackage{verbatim}
\graphicspath{{figures/}}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

\thispagestyle{empty}

%
%	This is a basic LaTeX Template for the TP/MP MSc Dissertation report

\parindent=0pt          %  Switch off indent of paragraphs 
\parskip=5pt            %  Put 5pt between each paragraph  

%	This section generates a title page
%       Edit only the sections indicated to put in the project title, and submission date

\vspace*{0.1\textheight}

\begin{center}
        \huge{\bfseries Event Attribution}\\ % Replace with the title of your dissertation!
\end{center}

\medskip

\begin{center}
        \Large{Christopher Long}\\  % Author of dissertation - replace with your name!
        \medskip
        \large{August 18, 2023}  % Submission date
\end{center}

%%% If necessary, reduce the number 0.4 below so the University Crest
%%% and the words below it fit on the page.
%%% Don't let the crest, or the wording below it, flow onto the next page!

\vspace*{0.4\textheight}

\begin{center}
        \includegraphics[width=35mm]{crest.pdf}
\end{center}

\medskip

\begin{center}

\large{
  MSc in Mathematical Physics\\[0.8ex]
  The University of Edinburgh\\[0.8ex]
  2023}

\end{center}

\newpage


\pagenumbering{roman}

\begin{abstract}

Extreme rainfall on 12 August 2020 caused the Stonehaven Derailment,
    which resulted in three deaths.
This project applies current event attribution techniques for extreme rainfall events,
    finding a probability ratios for the extreme rainfall to be 1.1, 1.3 and 1.6 for the 1980s, 2010s and in a 2K warmer world
    respectively over pre-industrial.

\end{abstract}

\pagenumbering{roman}

\begin{center}
\textbf{Declaration}
\end{center}

I declare that this report is entirely my own work unless stated otherwise.

The introduction~\ref{ch:intro} describes the motivations for the work.
This includes the information showing the impact of the extreme rainfall on the derailment by the Rail Accident Investigation Board~\cite{RAIB_2022},
    as well as my supervisor's paper analysing the effect of climate change on the risk of an extreme rainfall event~\cite{Tett_Soon}.

Chapter~\ref{ch:attribution} contains background material,
    with the first and third sections primarily relying on World Weather Attribution's methodology~\cite{van_Oldenborgh_et_al_2021},
    and the second section makes use of the information in Coles' textbook on the topic~\cite{Coles_2001}.

Chapter~\ref{ch:dev} consists of my own work,
    excepting the use of code and creation of equivalent diagrams to a currently approved but not yet published paper by my supervisor.
Code used in this project is given in~\cite{Me_Code},
    code used in my supervisor's paper is given in~\cite{Tett_Code}

Chapter~\ref{ch:results} is entirely my own work.

\bigskip

Calculations used Python with many standard packages.

NumPy and XArray are used to manage and process both real and modelled rainfall data.

CartoPy is used to process data between both Ordinance Survey and Longitude-Latitude coordinate systems.

R and the RPy package are used to fit extreme value distributions to the rainfall data.

The data processing ran on both the JASMIN supercomputer and on my local machine,
GitHub was used to manage the transfer of both code and data.

The majority of the code used in this project is based on the code used by my supervisor performing a similar analysis on the 2021 Edinburgh cloudburst.


\newpage

\begin{center}
\textbf{Personal Statement} % Use Git commits
\end{center}

I spent the first 2 weeks of the project retro-fitting the Edinburgh castle
library to apply to the Stonehaven crash.
This process began by creating plots including the
rainfall at the crash location on the day and an animation of the rainfall
in the Stonehaven region, allowing me to find an appropriate event definition.

For the remaining weeks of June, I implemented a topographical height mask
to the radar data, as well as establish a workspace to transfer data between
my laptop and the JASMIN supercomputer.

Following this I began my analysis of the radar data.
This involved computing and plotting the monthly rainfall maxima in
the Stonehaven region, as well as finding the quantiles of these extrema,
as well as using R to find the parameters of a GEV fit to both the empirical
and a monte carlo bootstrap of the rainfall distribution.

In mid-July, I created plots for these distributions and started to work with the Convection Permitting Model data,
    processing it as necessary to be appropriate for the use case.
This allowed me to create the time series to act as covariates to the CPM rainfall data,
    which were used in the first week of August to compute the probability ratios, intensity ratios and plots.
Any work done in August other than writing up the dissertation was spent analysing and critiquing the techniques used.

I started writing this dissertation in mid-July, and I spent the first
three weeks of August working on it full-time.

I have achieved the final outcome of a probability ratio, and %  TODO discuss analysis


\newpage

\begin{center}
%\vspace*{2in}
% an acknowledgements section is completely optional but if you decide
% not to include it you should still include an empty {titlepage}
% environment as this initialises things like section and page numbering.
\textbf{Acknowledgements}
\end{center}

I'd like to thank my supervisor Professor Simon Tett for
making this project possible.



\tableofcontents
\listoftables
\listoffigures

\pagenumbering{arabic}

\chapter{Introduction}\label{ch:intro}



\begin{comment}
The Introduction should contain a description of your project and the
problem you are trying to solve. It should start off at a level that
should be understandable by anyone with a degree in physics, but it
can become more technical later

Where appropriate you should include references to work that has
already been done on your topic and anything else which lets you set
your work in context.
\end{comment}

\chapter{Event Attribution Theory}\label{ch:attribution}

As a part of a complex system,
    any weather event is necessarily multifactorial,
    with no single cause.
It is therefore necessary to use a probabilistic lens to perform a scientific analysis.

In this case, the weather at a given place and time of year is expressed as a statistical distribution of events.
The climate may then be considered either the distribution itself,
    or the parameters informing the distribution.
In other words, ``Climate is what we expect, weather is what we get.''~\cite{Herbertson_1935}.

The scientific method may then be applied,
    using the climate distribution as a dependent variable to the factor being considered.
Issues, of both a technical and a theoretical nature can arise with this approach,
    and will be discussed in subsection~\ref{sec:attrchallenge}.

In all the examples given in this section,
    the independent variable is anthropogenic climate change.
This is often quantified by using a temperature metric,
    although additional factors may be considered.

It may be noted that,
    due to their generality,
    climate event attribution techniques may be of use outside risk analysis from modern changes in the climate.
For example,
    Ruddiman~\cite{Ruddiman_2010} has attempted to attribute the lack of a recent glaciation to the beginning of agriculture.

An event attribution study aims to provide two quantities.
The first is the change in the probability of the event.
The second is the change in the magnitude of the event.

\subsubsection{Development of Event Attribution}

In 2003, whilst experiencing flooding as a result of extreme weather,
    Allen~\cite{Allen_2003} posited the probabilistic interpretation of climate change impacts,
    proposing a potential to find greenhouse gas emitters liable for extreme weather events.
%  Add note about the fact that a grant would not be paid to emitters for reducing the likelihood.
A notable early use case of this probabilistic approach was by Stott et al.~\cite{Stott_2004},
    finding that 75\% of the risk of the European heatwave is attributable to anthropogenic climate change.

World Weather Attribution produces rapid Event Attribution studies,
    some of which are within a month of the event occuring~\cite{van_Oldenborgh_et_al_2018},
    using the probabilistic approach.
Alternative approaches also exist.
One of these is the `Boulder' methodology,
    described in section 2.2 of~\cite{Otto_2017},
    which seeks to break down the proportions to which the event was caused by natural variability and the due to Anthropogenic Climate Change.
Another is the `storyline' methodology,
    outlined by Shepherd et al. in~\cite{Shepherd_et_al_2018},
    although this has been considered contentious~\cite{García-Portela_Maraun_2023}.

\section{Steps to Event Attribution}\label{sec:attrsteps}

The precise number of steps for successful event attribution vary by the situation.
Van Oldenborgh et al.~\cite{van_Oldenborgh_et_al_2021} give 8 separate steps,
    while Otto~\cite{Otto_2017} gives 6 steps.
Both of these methodologies are functionally identical;
    I shall base my description upon 4 of the steps described by Otto.

Only four steps are given in full below.
This is due to the removal of an analysis trigger step at the start of the process
    and a communication step at the end of the process,
    both of which I will cover here briefly.

An analysis trigger is a set of criteria used by researchers to determine whether an event should be investigated.
These serve a utilitarian purpose,
    allowing the events with the greatest impact to be investigated first.
These may include the number of deaths or number impacted,
    as in chapter 2 of~\cite{van_Oldenborgh_et_al_2021},
    or economic and cultural factors, as in~\cite{Tett_Soon}.
The former criteria may skew analysis towards poorer nations~\cite{Kahn_2005},
    while the latter may skew analysis towards richer nations.

It is of note that potential liability of anthropogenic climate change may be a triggering factor,
    so the analysis begins due to a hypothesis that the event was caused by anthropogenic climate change.
I believe that this may bias the results of a meta-analysis of event attribution studies,
    and so increase the challenge in determining anthropogenic climate change as a cause of more extreme events in general.
I omit giving any further detail on the analysis trigger as it is beyond the scope of mathematical or physical interest.

The communication of the outcome of the analysis may also be considered in the study.
This is especially true outside the scientific community
    and considers the risk of the audience drawing incorrect conclusions,
    as well as the risk of policymakers acting on incorrect information.

\subsection{Event Definition}\label{subsec:backeventdef}

To perform an attribution analysis,
    the weather event must first be defined in clear and quantitative terms.
This requires specifying a variable with a threshold that has been crossed,
    as well as the time and region at which an event may be considered.

This is not necessarily straightforward.
An event attribution is normally triggered by the event's social or environmental impact,
     not just due to the meteorological significance.
Therefore, care must be taken to ensure that the definition of the event is sufficiently similar to the conditions that would cause a similar impact.

Many of the challenges in Event Attribution arise directly from a poor Event Definition.
Events that are too narrowly defined may have issues with reproducibility,
    as will be discussed in~\ref{subsec:eventrepro},
    while events that are too widely defined may give invalid results,
    as will be discussed in~\ref{subsec:modelvalid}.

\subsubsection{Variable and Threshold}

The climate variable used to define the event requires travelling up the causal chain that leads to it.
As a set of examples,
    floods/droughts are caused by extreme highs/lows in rainfall,
    while heat waves and cold spells are caused by extreme high or low temperatures.

However,
    all of these events require the extreme rainfall/temperature to be sustained for the event to be hazardous.
Simple metrics may be applicable here,
    as the definition can then use the rainfall/temperature averaged over a given time period.
The selection of time period itself also requires a consideration of the event.
A damaging heavy storm requires extreme winds over a matter of minutes,
    while it may take days for the land to dry out sufficiently for a drought to occur.

More advanced metrics may be used.
For example, an Expert Team on Climate Change Detection Indices~\cite{Zhang_2011}
    describes a `Growing Season Length',
    allowing climate-caused famine to be quantified using only daily temperature data.
A `Wet-Bulb Temperature' has been used to combine humidity and temperature data to create an index that better measures teh effect of a heatwave on human health~\cite{Li_2020}.

\subsubsection{Spatial and Temporal Region}

In addition to defining a threshold variable,
    it is necessary to define the regions and times at which an event can be considered sufficiently similar to that being analysed.
This is due to the fact that both historical trend analysis is impossible on a single extreme event at a single place on a single day of the year
    and that climate models will rarely reproduce events in such a narrow definition.
The second of these factors will be discussed in subsection~\ref{subsec:eventrepro}.

For the spatial region,
    a region with a known climate similar to that in which the event occurred is chosen,
    typically directly around the location of the event.
This is done so that the frequency and types of event will match the location of the original event,
    as well as to ensure that the factors that change the climate,
    whether Anthropomorphic or not,
    are similar to those changing the climate at the point of the event.

In addition to the aforementioned similarity in location,
    a historical trend analysis can aid in defining a region,
    along with tools including topography and climate classifications.
The region is chosen based on similar weather,
    not a similarity in hazard risk,
    as the goal is to perform an attribution for the event,
    not to advise on potential future risk.
For example,
    a region defined for a flood event over a flood-prone area would only consider areas with similar rainfall,
    not those similarly flood-prone.

For the temporal region,
    or time period for the event to be considered,
    an analogous process must be used.
It is often appropriate to use a seasonal time period,
    as this can also limit the event to those with similar meteorology,
    such as by only considering monsoon rainfall~\cite{Otto_et_al_2023}.
This can also prove to be a practical step,
    reducing the amount of data to be used later in the attribution process.

Additional `Boundary Conditions'~\cite{van_Oldenborgh_et_al_2021} may then also be imposed.
Of note is the importance of the El Niño,
    especially for drought events in the southern hemisphere~\cite{Lyon_2004},
    so this may also be accounted for when defining these event.

Once all of these definitions have been made,
    a `class' of events has been described.
This class will then be used to find like events in both the historical and model data.

\subsection{Model Evaluation}\label{subsec:backmodeleval}

\subsection{Likelihood Estimation}\label{subsec:backlikeest}

\subsection{Interpretation}\label{subsec:backinterp}

\section{Extreme Value Statistics}\label{sec:exstats}

This subsection will describe the statistical foundations of extreme event modelling,
    paraphrasing Coles' book~\cite{Coles_2001} unless where otherwise stated.
Climate events that pose hazards are necessarily extreme.
Therefore, to model these events,
    extreme value distributions are necessary.

Throughout the analysis,
    we assume that the variables are independent and identically distributed ($i.i.d.$).
The issues that may arise from this assumption not being valid are considered in subsection~\ref{subsec:statvalid}.

For event definitions which average a variable over a season,
    as opposed to focusing on the extreme
    a normal distribution is instead appropriate.
This is as the Central Limit Theorem states that the limit of the mean of $n$ $i.i.d.$ random variables tends to a normal distribution.
The equivalents for extreme events, the GEV distribution and Extremal Types Theorem,
    will be explained in due course.

\subsection{GEV Distribution}\label{subsec:gev}

\subsubsection{Extremal Types Theorem}

This explanation is as given in section 3.1 of~\cite{Coles_2001}.

Let $M_n$ be the maximum of $n$ $i.i.d.$ random variables.
If there exist sequences of constants $a_n > 0$ and $b_n$, and non-degenerate $G$ such that:

\[ P\left( \frac{M_n - b_n}{a_n}  \leq z \right) \rightarrow G(z) \text{ as } n \rightarrow \infty \]

Then $G$ is a member of the GEV (Generalised Extreme Value) family.

Section 3.1.4  of~\cite{Coles_2001} outlines a proof of the Extremal Types Theorem.
This involves showing that being a GEV distribution is equivalent to being `Max-Stable',
    then that the maxima of GEV distributions are Max-Stable,
    giving the GEV as the distribution of the original maximum in the infinite limit.
It is of note that this is similar to one approach to proving the Central Limit Theorem,
    which considers the normal distribution as a unique fixed point under convolutions,
    resulting in normal distributions being an infinite limit of the sum or mean~\cite{Hamedani_Walter_1984}.

Section 3.5 of~\cite{Coles_2001} shows, \textit{mutatis mutandis},
    that the extremal types theorem applies identically to minima by reversing the sign of the data.

\subsubsection{Parameters and Types of GEV distributions}

The GEV distribution has a CDF given by:

\[ G(z) = \exp \left( - \left( 1 + \xi \left( \frac{z-\mu}{\sigma} \right)  \right)^{-\frac{1}{\xi}} \right) \]

This has three parameters, the location $\mu$, the scale $\sigma$ and the shape $\xi$.
It is clear from this CDF that the change of location and scale parameters represent moving and rescaling the distribution,
    much as the mean and standard deviation parameters do for a normal distribution.

The shape parameter determines the thickness of the tail of the distribution.
The larger the shape parameter, the thicker the tail of the distribution.

%  TODO insert graph w different shape parameters

Where $\xi > 0$,
    the distribution is heavy-tailed.
This type of GEV distribution is also known as a Fr\'{e}chet distribution.
Special cases of this distribution have unique properties,
    where $\xi \geq \frac{1}{2}$, the distribution has infinite variance and
    where $\xi \geq 1$, the distribution has infinite mean.

Where $\xi < 0$, the distribution is light-tailed,
    also known as a reversed Weibull distribution.
These distributions are limited to a maximum `most extreme' value of $\mu - \frac{\sigma}{\xi}$.
It can therefore be expected that distributions modelling extrema with physical constraints would have a negative shape parameter.
For example, Table 3 of Chikobvu and Chifurira's paper~\cite{Chikobvu_2015} modelling rainfall minima finds a negative shape parameter,
    which would be expected as rainfall cannot be negative.

Where $\xi = 0$,
    the distribution is a Gumbel distribution.
The CDF of this distribution requires taking the limit as $\xi \rightarrow 0$,
    giving a double exponential CDF\@.
The extrema of normal distributions converge to a Gumbel distribution,
    shown as a step in the proof of Proposition 1 of~\cite{Bailey_2014}.
This means that, with the Central Limit Theorem,
    the maxima of a sample of means of any distribution approaches a Gumbel distribution as both samples grow larger,
    provided the samples are independent.

The above paragraph suggests that a Gumbel distribution is appropriate for modelling rainfall maxima,
    as the rainfall is averaged over a time period and then a maxima is taken over those time periods for a given year or season.
However, this has not been found to be true.
Koutsoyiannis~\cite{Koutsoyiannis_2003} finds both an ``extremely slow'' theoretical convergence to a Gumbel distribution and
    that the Gumbel distribution does not fit empirical rainfall maxima.
Therefore, the three-parameter GEV distribution is used to model rainfall maxima in event attribution.

\subsubsection{Return levels of GEV distributions}

\subsection{Generalised Pareto Distribution}\label{subsec:gpd}

\section{Challenges in Event Attribution}\label{sec:attrchallenge}

\subsection{Event Reproducibility}\label{subsec:eventrepro}

\subsection{Statistical Reliability}\label{subsec:statvalid}

\subsection{Validity of Model}\label{subsec:modelvalid}

\chapter{Development}\label{ch:dev}

\section{Event Definition}\label{sec:def}

\subsection{The Stonehaven Event}\label{subsec:actualevent}

\subsubsection{Rainfall at the crash location}

%  TODO insert plot of stonehaven morning rainfall

\subsubsection{Rainfall in the Stonehaven region}

%  TODO insert several hourly plots of the storm passing

\subsection{Definition and Constraints}\label{subsec:defandcons}

\subsubsection{Stonehaven Geography}

%  TODO insert geography/height map, note Koppen classification

\subsection{Processing and Fitting the Radar Data}\label{subsec:radarprocess}

\subsubsection{Computing Maxima}

\subsubsection{Computing Events}

%  TODO discuss ok_count implication on size of event

\subsubsection{Fitting event distribution}

%  TODO mention monte carlo bootstrap

\subsubsection{Annual rainfall maxima}

\section{Event Modelling}\label{sec:model}

%  TODO insert chart w various coarsenings

\chapter{Results and Analysis}\label{ch:results}

%  TODO mention lack of trend analysis due to lack of radar data

\section{Results}\label{sec:results}

\begin{comment}
This section should give a picture of what you have taken out of your
project and how you can put it into context.

This section should summarise the results obtained, detail conclusions
reached, suggest future work, and changes that you would make if you
repeated the project.
\end{comment}
\begin{comment}
This section should detail the obtained results in a clear,
easy-to-follow manner. It is important to make clear what are original
results and what are repeats of previous calculations or computations.
Remember that long tables of numbers are just as boring to read as
they are to type-in!

Use graphs to present your results wherever practicable.

Results or computations should be presented with uncertainties
(errors), both statistical and systematic where applicable.

Be selective in what you include: half a dozen \emph{e.g.}~tables that
contain wrong data you collected while you forgot to switch on the
computer are not relevant and may mask the correct results.
\end{comment}

\subsection{Radar Data Fit}\label{subsec:radardatafit}

%  TODO insert return chart

\subsection{Model Correlations}\label{Model Correlations}

%  TODO insert CET scatter

\subsection{Risk Ratios}\label{subsec:riskratio}

%  TODO insert prob_radar_CPM

%  TODO insert plot showing overlap of distributions w/ parameters

\section{Discussion of your results}\label{sec:discussion}

\chapter{Conclusions}\label{ch:conclusions}

\begin{comment}
This is the place to put your conclusions about your work. You can
split it into different sections if appropriate. You may want to include
a section of future work which could be carried out to continue your
research.

The conclusion section should be at least one page long, preferably 2
pages, but not much longer.
\end{comment}

\appendix
% the appendix command just changes heading styles for appendices.

\chapter{Stuff that's too detailed}

Appendices should contain all the material which is considered too
detailed to be included in the main body of the text, but which is
important enough to be included in the thesis.

Perhaps this is a good place to mention \BibTeX.

You can do references in the simple way explained in the introduction,
or you can use \BibTeX.


\bibliographystyle{unsrt}
\bibliography{ref}




\end{document}

